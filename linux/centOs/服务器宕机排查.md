



https://wenku.baidu.com/view/ce56174f7d21af45b307e87101f69e314332fa69.html

#  æ’æŸ¥å†…å­˜å ç”¨æƒ…å†µ

åœ¨LinuxæœåŠ¡å™¨ä¸­ï¼Œå¦‚æœä½ æƒ³æ’æŸ¥å†…å­˜ä½¿ç”¨è¾ƒé«˜çš„åº”ç”¨ï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œ

### 1. **æŸ¥çœ‹æ€»ä½“å†…å­˜ä½¿ç”¨æƒ…å†µ**

```bash
free -h
```

æŸ¥çœ‹å†…å­˜æ€»é‡ã€å·²ä½¿ç”¨ã€ç¼“å­˜ã€swapç­‰ã€‚

------

###  2. **ä½¿ç”¨ top / htop æ’æŸ¥å†…å­˜å¤§æˆ·**

#### `top` å‘½ä»¤

```bash
top
```

è¿›å…¥åæŒ‰ä¸‹ï¼š

- `M`ï¼šæŒ‰å†…å­˜å ç”¨æ’åºï¼ˆé»˜è®¤æ˜¯CPUï¼‰
- æŸ¥æ‰¾ `RES` æˆ– `%MEM` å­—æ®µå ç”¨æœ€é«˜çš„è¿›ç¨‹

#### æ›´ç›´è§‚ç‰ˆæœ¬ï¼š`htop`ï¼ˆéœ€å®‰è£…ï¼‰

```bash
htop
```

é¢œè‰²æ›´å‹å¥½ï¼Œæ”¯æŒäº¤äº’æ“ä½œã€‚

------

###  3. **æŸ¥çœ‹å ç”¨å†…å­˜æœ€å¤šçš„å‰10ä¸ªè¿›ç¨‹**

```bash
ps aux --sort=-%mem | head -n 10
```

è¾“å‡ºç¤ºä¾‹ï¼š

```bash
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
nginx     1234  1.2 15.4 123456 32100 ?        S    10:00   0:02 nginx: worker process
mysql     2345  5.3 12.7 456789 26700 ?        Ssl  09:58   1:25 /usr/sbin/mysqld
```

- `%MEM` æ˜¯å†…å­˜å ç”¨æ¯”ä¾‹
- `RSS` æ˜¯å®é™…å ç”¨çš„ç‰©ç†å†…å­˜ï¼ˆå•ä½æ˜¯KBï¼‰

------

###  4. **æŒ‰åº”ç”¨åç»Ÿè®¡å†…å­˜å ç”¨ï¼ˆå¦‚ Nginx / Javaï¼‰**

å¦‚æœä½ æƒ³çŸ¥é“æ¯ç±»åº”ç”¨å ç”¨å¤šå°‘å†…å­˜ï¼Œå¯ä»¥ç”¨ `smem` å·¥å…·ï¼ˆæ›´å‡†ç¡®ï¼‰

#### å®‰è£… smemï¼š

```bash
sudo apt install smem   # Debian/Ubuntu
sudo yum install smem   # CentOS/RHEL
```

#### ä½¿ç”¨ smem æŸ¥çœ‹åº”ç”¨æ€»ä½“å†…å­˜å ç”¨ï¼š

```bash
smem -r -k | sort -nr -k 4 | head
```

æˆ–è€…åˆ†ç»„æŸ¥çœ‹æ€»å ç”¨ï¼š

```bash
smem -c "name user pss" -r | awk '{a[$1]+=$3} END{for(i in a) print i,a[i]}' | sort -k2 -nr | head
```

------

###  5. **æŸ¥çœ‹æ˜¯å¦ç¼“å­˜å ç”¨è¾ƒé«˜ï¼ˆéå®é™…è¿›ç¨‹ï¼‰**

```bash
free -m
```

æ³¨æ„ `buffers/cache` éƒ¨åˆ†ï¼ŒLinuxä¼šæŠŠç©ºé—²å†…å­˜ç”¨äºç¼“å­˜ï¼Œæé«˜æ€§èƒ½ï¼Œä½†å¹¶ä¸æ˜¯â€œçœŸæ­£è¢«å æ»¡â€ã€‚

------

###  6. **å…¶ä»–å·¥å…·æ¨è**

- `vmstat 1`ï¼šè§‚å¯Ÿå†…å­˜ã€swapã€IO ä½¿ç”¨æƒ…å†µ
- `dstat`ï¼šæ›´å…¨é¢çš„ç³»ç»Ÿèµ„æºç›‘æ§
- `glances`ï¼šå…¨èƒ½å‹ç³»ç»Ÿç›‘æ§ï¼ˆéœ€å®‰è£…ï¼‰

------

å¦‚æœä½ æŠŠä½ çš„ `top` æˆ– `ps aux` è¾“å‡ºè´´ä¸Šæ¥ï¼Œæˆ‘å¯ä»¥å¸®ä½ å…·ä½“åˆ†ææ˜¯è°åœ¨åƒå†…å­˜ ğŸ˜

æ˜¯å¦è¿è¡Œäº†å¦‚ï¼š

- Java / Node / Python / MySQL / Redis / Docker / å®¹å™¨ï¼Ÿ
- æœ‰æ²¡æœ‰è·‘ Web åº”ç”¨æˆ–å¤§æ•°æ®ä»»åŠ¡ï¼Ÿ





# å®æˆ˜æ¡ˆä¾‹

##  å‘ç°crontabå®šæ—¶ä»»åŠ¡å¹²äº†1ä¸ªGå†…å­˜

> ä½¿ç”¨å‘½ä»¤å‘ç° å ç”¨æœ€å¤šçš„è¿›ç¨‹

```shell
root@hcss-ecs-739f:~# ps aux --sort=-%mem | head -n 10
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root      200743  0.1  4.3 1839960 79576 ?       Ssl  09:47   0:00 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
root         411  0.0  1.4 289316 27100 ?        SLsl Feb07   5:13 /sbin/multipathd -d -s
root       73180  0.0  1.2  80508 23208 ?        S<s  Apr07   0:14 /lib/systemd/systemd-journald
root        8006  0.0  1.2 1949496 23196 ?       Ssl  Feb07  50:31 /usr/bin/containerd
root     2374460  0.0  1.2  42236 23180 ?        S    Mar11  14:26 python3 /root/agent301-claimer/bot.py
root     2584422  0.0  1.2  42200 23148 ?        S    Mar14  10:44 python3 /root/agent301-claimer/bot.py
root     2881259  0.0  1.2  42260 23112 ?        S    Mar18   6:58 python3 /root/agent301-claimer/bot.py
root     1739068  0.0  1.2  44072 22984 ?        S    Feb24  50:08 python3 /root/agent301-claimer/bot.py
root     2025905  0.0  1.2  43816 22804 ?        S    Mar03  31:18 python3 /root/agent301-claimer/bot.py
```

###  ä¸€æ¬¡æ€§å…³é—­æ‰€æœ‰ç›¸å…³è¿›ç¨‹

æ–¹æ³• 1ï¼šé€šè¿‡ `pkill` æŒ‰å‘½ä»¤åç»Ÿä¸€å…³é—­

> `-f` æ˜¯åŒ¹é…å®Œæ•´å‘½ä»¤è¡Œï¼ˆå› ä¸ºä½ æœ‰è·¯å¾„ `/root/...`ï¼‰
>
> **æ³¨æ„ï¼š** å¦‚æœä½ æœ‰å¤šä¸ªä¸åŒ bot.py è¦åˆ†åˆ«æ§åˆ¶ï¼Œåˆ«ç›´æ¥ pkillï¼

```shell
pkill -f "python3 /root/agent301-claimer/bot.py"
```

