# 正则表达式

[**输入只能是英文或者数字**](https://zhidao.baidu.com/question/1674617561258447347.html)

```php
'id_card'=>'regex:/^[a-zA-Z0-9]+$/u'        # 例如s
```

# 自定义验证规则

```php
 # 控制器中代码 
  $validate  = new ServiceSaveValidator();
  $result=$validate->check($data);
 if ($result !== true) {
      throw new SystemException($validate->getError());
  }
# 定义异常类
<?php

namespace app\admin\validate;

use think\Validate;

class ServiceSaveValidator extends Validate
{
    protected $rule = [
        "introduce"=>'require',
        "service_imgs" => 'isMax|maxMaster',
    ];
    protected $message = [
        "introduce"=>'服务简介不能为空',
        'service_imgs.isMax'=>'最多只能上传三张服务图片',
        'service_imgs.maxMaster'=>'最多只能有一个主图',
    ];

    // 自定义验证规则   $data d
    protected function isMax($value, $rule, $data = [])
    {
        if (empty($value)||count($value)<=3) {
            return true;
        }
        if (count($value) >= 3) {
            return false;
        }
        return false;
    }
    protected function maxMaster($value, $rule, $data = [])
    {

        if (empty($value)) {
            return true;
        }
        $arr=array_column($value,'is_master');
        $bools=array_count_values($arr);
        return $bools['true']>1?false:true;
    }
}
```

