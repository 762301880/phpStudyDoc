



## 实例逻辑

```php
    public static function uploadImage(Request $request)
    {
        $file = $request->file('file');
        if (empty($file)) throw new ApiException('上传图片不能为空');
        # 验证上传图片格式
        if (!in_array($file->extension(), ['jpg', 'jpeg', 'png', 'bpm', 'gif', 'svg', 'webp'])) {
            throw new ApiException('上传文件必须是 jpg、jpeg、png、bpm、gif、svg、webp 其中的一种');
        }
        # 验证上传图片大小
        if (floor($file->getSize() / (1024 * 1024) > 5)) {
            throw new ApiException('上传文件必须保持在5M以内');
        }
        $file_name = uniqid() . '@' . $file->getOriginalName(); # 定义上传图片得唯一名称
        $uploadDirectory = "/temp_uploads/" . date('Ymd');  #定义上传文件得路径
        $savePath = public_path($uploadDirectory);  # 定义上传绝对路径
        //文件路径如果不存在则自动创建 并赋予权限
        if (!is_dir($savePath)) mkdir($savePath, 0777, true);
        $file->move($savePath, $file_name); //上传图片
        if (!file_exists($savePath . '/' . $file_name)) throw new ApiException("上传文件失败");
        return request()->domain() . "$uploadDirectory/" . $file_name; //返回上传的名称
    }
```

