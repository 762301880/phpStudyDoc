# B站24小时无人直播

## kplayer实现

| name               | url                                                          |
| ------------------ | ------------------------------------------------------------ |
| 网络博客           | [link](https://www.bilibili.com/read/cv23932834/#:~:text=%E9%A6%96%E5%85%88%E6%89%93%E5%BC%80%E4%B8%AAb%E7%AB%99%E6%88%91%E7%9A%84%E7%9B%B4%E6%92%AD%EF%BC%8C%E5%B0%86%E8%87%AA%E5%B7%B1%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%B0%E5%9D%80%E5%92%8C%E4%B8%B2%E6%B5%81%E5%AF%86%E9%92%A5%E5%A4%8D%E5%88%B6%E4%B8%8B%E6%9D%A5%20%E4%B8%A4%E4%B8%AA%E5%9C%B0%E5%9D%80%E6%8B%BC%E6%8E%A5%E8%B5%B7%E6%9D%A5,%E7%BA%A2%E8%89%B2%E5%88%92%E7%BA%BF%E9%83%A8%E5%88%86%E9%9C%80%E8%A6%81%E4%BF%AE%E6%94%B9%EF%BC%8C%E5%B0%86%E8%87%AA%E5%B7%B1b%E7%AB%99%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%B0%E5%9D%80%E5%92%8C%E4%B8%B2%E6%B5%81%E5%AF%86%E9%92%A5%E5%A4%8D%E5%88%B6%E5%88%B0%E8%84%9A%E6%9C%AC%E4%B8%AD%EF%BC%8C%E5%90%8C%E6%97%B6%E4%BF%AE%E6%94%B9%E8%A7%86%E9%A2%91%E7%9A%84%E5%90%8D%E7%A7%B0%20%E8%BE%93%E5%85%A5%E4%B8%8A%E4%BC%A0%E7%9A%84%E8%A7%86%E9%A2%91%E5%90%8D%E7%A7%B0%E5%92%8C%E6%8E%A8%E6%B5%81%E5%9C%B0%E5%9D%80%20%E4%BF%AE%E6%94%B9%E5%90%8E%E4%BF%9D%E5%AD%98%EF%BC%8C%E5%B9%B6%E4%B8%94%E9%80%9A%E8%BF%87fz%E4%B8%8A%E4%BC%A0%E8%87%B3kplayer%E6%96%87%E4%BB%B6%E5%A4%B9%E5%86%85)  [link](https://www.bilibili.com/read/cv27554887/?from=search&spm_id_from=333.337.0.0) |
| kplayer官方文档    | [link](https://docs.kplayer.net/v0.5.8/)                     |
| kplayer_docker地址 | [link](https://hub.docker.com/r/bytelang/kplayer)            |



```shell
# 在服务器命令行页面,输入 安装

curl -fsSL get.kplayer.net | bash
```

获取直播推流地址 

> 进入【B站】 -> 点击【直播】 -> 点击【开播设置】 -> 选择分类，点击【开始直播】(需要实名身份证认证) -> 获取【服务器地址】和【串流密钥】

![img](https://i0.hdslb.com/bfs/article/d0470a3c5235b9d8fcc60c0692e0419644028940.png@1256w_634h_!web-article-pic.avif)

> 上面的 服务器地址+串流秘钥 拼接起来 就是你推流的地址
>
> 比如格式：rtmp://live-push.bilivideo.com/live-bvc/?streamname=live_******_******&key=**************&schedule=rtmp&pflag=1 

**配置文件信息**

>  配置KPlayer 的**config.json**配置文件

```shell
{
  "version": "2.0.0",
  "resource": {
    # 容器中存放视频的文件夹
    "lists": ["/video"],
    # 过滤允许播放的文件类型，如mp4、flv等
    "extensions": []
  },
  "output": {
    "lists": [
      {
        # 推流地址
        "path": "rtmp://live-push.bilivideo.com/live-bvc/?streamname=live_******_******&key=**************&schedule=rtmp&pflag=1"
      }
    ],
    "reconnect_internal": 5
  },
  "play": {
    "fill_strategy": "ratio",
    "skip_invalid_resource": true,
    # 启用推流编码缓存，会生成缓存，命中缓存节约CPU资源
    "cache_on": true,
    # 播放模式，目前为按顺序且循环播放，其他参数请参考KPlayer文档
    "play_model": "loop"
  }
} 
```



**启动**

```shell
./kplayer play start --daemon
```

##  docker启动kplyer

```shell
docker run  -td --name=kplayer -v /root/docker_data/kplayer/video:/video -v  /root/docker_data/kplayer/config.json:/kplayer/config.json -v /root/docker_data/kplayer/cache:/kplayer/cache  --restart=always  bytelang/kplayer:latest 


# 我的配置
docker run  -td --name=kplayer -v /www/aliyun/:/www/aliyun/  -v  /root/docker_data/kplayer/config.json:/kplayer/config.json -v /root/docker_data/kplayer/cache:/kplayer/cache  --restart=always  bytelang/kplayer:latest 
```

