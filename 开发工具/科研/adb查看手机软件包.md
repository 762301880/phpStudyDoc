# èµ„æ–™

| åç§°              | åœ°å€                                                         |
| ----------------- | ------------------------------------------------------------ |
| adbå·¥å…·å®˜æ–¹å®‰è£…åŒ… | [link](https://developer.android.google.cn/tools/adb?hl=en)     [download](https://developer.android.google.cn/tools/releases/platform-tools?hl=en) |
| ç½‘ç»œåšå®¢          | [link](https://www.cnblogs.com/ximaomao/p/14081479.html)    [link](https://www.zhihu.com/question/1945235889400840530/answer/1946552391777378582) |
| adbå®˜æ–¹ä¸­æ–‡æ–‡æ¡£   | [link](https://developer.android.com/tools/adb?hl=zh-cn)     |



# ç¯å¢ƒå˜é‡é…ç½®

ä¾‹å¦‚æˆ‘çš„è§£å‹ç›®å½•æ˜¯`D:\Program Files\platform-tools`    ç›´æ¥æŠŠè¿™ä¸ªé…ç½®åˆ° **ç³»ç»Ÿå˜é‡  -   Path**  å˜é‡é‡Œå³å¯

#  æ‰‹æœºå¼€å¯USBè°ƒè¯•

vivoæ‰‹æœº   **ç³»ç»Ÿç®¡ç†>å¼€å‘è€…é€‰é¡¹>USBè°ƒè¯•**

#  ä½¿ç”¨

1. å®‰è£… ADB å·¥å…·ï¼š

   - å¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£… ADBï¼Œå¯ä»¥ä» Android å¼€å‘è€…å®˜ç½‘ ä¸‹è½½ Android SDK Platform-Toolsã€‚

2. è¿æ¥è®¾å¤‡ï¼š

   - ä½¿ç”¨ USB æ•°æ®çº¿å°†ä½ çš„ Android è®¾å¤‡è¿æ¥åˆ°ç”µè„‘ã€‚

   - åœ¨è®¾å¤‡ä¸Šå¯ç”¨å¼€å‘è€…é€‰é¡¹å’Œ USB è°ƒè¯•ã€‚é€šå¸¸å¯ä»¥åœ¨ è®¾ç½® > å…³äºæ‰‹æœº > è½¯ä»¶ä¿¡æ¯ ä¸­è¿ç»­ç‚¹å‡»â€œç‰ˆæœ¬å·â€7æ¬¡æ¥å¯ç”¨å¼€å‘è€…é€‰é¡¹ï¼Œç„¶ååœ¨ è®¾ç½® > ç³»ç»Ÿ > å¼€å‘

     é€‰é¡¹ ä¸­å¯ç”¨ USB è°ƒè¯•ã€‚

3. æ‰“å¼€å‘½ä»¤è¡Œå·¥å…·ï¼š

   - æ‰“å¼€ç»ˆç«¯ï¼ˆWindows ç”¨æˆ·å¯ä»¥ä½¿ç”¨ CMD æˆ– PowerShellï¼ŒMac å’Œ Linux ç”¨æˆ·å¯ä»¥ä½¿ç”¨ Terminalï¼‰ã€‚

4. è¿è¡Œ ADB å‘½ä»¤ï¼š

   - è¾“å…¥ä»¥ä¸‹å‘½ä»¤åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„åº”ç”¨åŠå…¶åŒ…åï¼š

     ```shell
     adb shell pm list packages
     #  å†™å…¥åˆ°ç£ç›˜
     adb shell pm list packages  > d:packagelist.txt
     ```

     å¦‚æœä½ æƒ³æŸ¥æ‰¾ç‰¹å®šåº”ç”¨çš„åŒ…åï¼Œå¯ä»¥ä½¿ç”¨ grep å‘½ä»¤è¿›è¡Œè¿‡æ»¤ï¼Œä¾‹å¦‚ï¼š

     ```shell
     adb shell pm list packages | grep com.example
     ```

     

# æ–¹æ³•äºŒï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº”ç”¨

å®‰è£…ç¬¬ä¸‰æ–¹åº”ç”¨ï¼š
åœ¨ Google Play å•†åº—ä¸­æœç´¢å¹¶å®‰è£…ä¸€äº›ä¸“é—¨ç”¨äºæŸ¥çœ‹åº”ç”¨åŒ…åçš„ç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œå¦‚ Package Name Viewerã€App Inspector ç­‰ã€‚
ä½¿ç”¨åº”ç”¨ï¼š
æ‰“å¼€å®‰è£…å¥½çš„ç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œå®ƒä¼šåˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„åº”ç”¨åŠå…¶åŒ…åã€‚ä½ å¯ä»¥é€šè¿‡æœç´¢æˆ–æ»šåŠ¨åˆ—è¡¨æ‰¾åˆ°ä½ éœ€è¦çš„åº”ç”¨åŒ…åã€‚
æ–¹æ³•ä¸‰ï¼šä½¿ç”¨è®¾å¤‡è‡ªå¸¦çš„è®¾ç½®
è¿›å…¥åº”ç”¨ä¿¡æ¯é¡µé¢ï¼š
æ‰“å¼€è®¾å¤‡çš„ è®¾ç½® åº”ç”¨ã€‚
é€‰æ‹© åº”ç”¨ æˆ– åº”ç”¨ç®¡ç†ã€‚
æ‰¾åˆ°ä½ æƒ³è¦æŸ¥çœ‹åŒ…åçš„åº”ç”¨ï¼Œç‚¹å‡»è¿›å…¥å…¶è¯¦ç»†ä¿¡æ¯é¡µé¢ã€‚
æŸ¥çœ‹åŒ…åï¼š
åœ¨åº”ç”¨çš„è¯¦ç»†ä¿¡æ¯é¡µé¢ä¸­ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ä¸ªâ€œåº”ç”¨ä¿¡æ¯â€æˆ–â€œé«˜çº§â€éƒ¨åˆ†ï¼Œé‡Œé¢ä¼šæ˜¾ç¤ºåº”ç”¨çš„åŒ…åã€‚å…·ä½“ä½ç½®å¯èƒ½ä¼šå› è®¾å¤‡å‹å·å’Œç³»ç»Ÿç‰ˆæœ¬è€Œæœ‰æ‰€ä¸åŒã€‚

#  æ¡ˆä¾‹

##  æ§åˆ¶æ‰‹æœºåˆ·è§†é¢‘

```shell
#!/bin/bash

# é¢œè‰²å®šä¹‰
GREEN='\e[32m'
YELLOW='\e[33m'
CYAN='\e[36m'
RESET='\e[0m'

counter=0  # åˆå§‹åŒ–è®¡æ•°å™¨

while true
do
  ((counter++))  # è®¡æ•°å™¨è‡ªå¢

  # å½©è‰²è¾“å‡ºå½“å‰æ¬¡æ•°
  echo -e "${GREEN}>>> æ­£åœ¨æ‰§è¡Œç¬¬ ${YELLOW}$counter ${GREEN}éæ»‘åŠ¨ ${RESET}"

  # æ‰§è¡Œæ»‘åŠ¨æ“ä½œ
  adb shell input swipe 500 1500 500 500 300

  # ç”Ÿæˆéšæœºå»¶è¿Ÿ
  delay=$(( ( RANDOM % 4 ) + 5 ))

  echo -ne "${CYAN}ğŸ•’ å€’è®¡æ—¶ï¼š ${RESET}"

  # åŠ¨æ€å€’è®¡æ—¶
  for ((i=delay; i>0; i--)); do
    echo -ne "${CYAN}${i} ç§’...${RESET} \r"
    sleep 1
  done

  echo ""  # æ¢è¡Œ
done
```

# ADBå‘½ä»¤é€ŸæŸ¥è¡¨

ä»¥ä¸‹æ˜¯å¸¸ç”¨ **ADBï¼ˆAndroid Debug Bridgeï¼‰å‘½ä»¤å¤§å…¨**ï¼Œæ¶µç›–äº†è®¾å¤‡è¿æ¥ã€åº”ç”¨ç®¡ç†ã€æ–‡ä»¶æ“ä½œã€æ—¥å¿—è°ƒè¯•ç­‰å¤šä¸ªæ–¹é¢ï¼Œé€‚åˆå¼€å‘ã€æµ‹è¯•åŠè°ƒè¯•ä½¿ç”¨ï¼š

------

### ğŸ”Œ ä¸€ã€è®¾å¤‡è¿æ¥ä¸ç®¡ç†



| å‘½ä»¤                                   | è¯´æ˜                           |
| -------------------------------------- | ------------------------------ |
| `adb devices`                          | æŸ¥çœ‹å·²è¿æ¥è®¾å¤‡åˆ—è¡¨             |
| `adb connect <ip>:<port>`              | è¿æ¥è¿œç¨‹è®¾å¤‡                   |
| `adb disconnect`                       | æ–­å¼€æ‰€æœ‰è¿œç¨‹è¿æ¥               |
| `adb kill-server` / `adb start-server` | é‡å¯ ADB æœåŠ¡                  |
| `adb get-state`                        | è·å–è®¾å¤‡çŠ¶æ€ï¼ˆdevice/offlineï¼‰ |
| `adb reboot`                           | é‡å¯è®¾å¤‡                       |
| `adb reboot bootloader`                | é‡å¯åˆ° bootloader æ¨¡å¼         |
| `adb reboot recovery`                  | é‡å¯åˆ° recovery æ¨¡å¼           |

------

### ğŸ“± äºŒã€å®‰è£…ä¸å¸è½½åº”ç”¨



| å‘½ä»¤                         | è¯´æ˜                     |
| ---------------------------- | ------------------------ |
| `adb install <apkè·¯å¾„>`      | å®‰è£… APK                 |
| `adb install -r <apkè·¯å¾„>`   | é‡æ–°å®‰è£…ï¼ˆä¿ç•™æ•°æ®ï¼‰     |
| `adb uninstall <åŒ…å>`       | å¸è½½åº”ç”¨                 |
| `adb uninstall -k <åŒ…å>`    | å¸è½½åº”ç”¨ä½†ä¿ç•™æ•°æ®å’Œç¼“å­˜ |
| `adb shell pm list packages` | åˆ—å‡ºæ‰€æœ‰åŒ…å             |

------

### ğŸ§­ ä¸‰ã€åº”ç”¨æ§åˆ¶ä¸å¯åŠ¨



| å‘½ä»¤                                                         | è¯´æ˜              |
| ------------------------------------------------------------ | ----------------- |
| `adb shell monkey -p <åŒ…å> -c android.intent.category.LAUNCHER 1` | å¯åŠ¨åº”ç”¨          |
| `adb shell am start -n <åŒ…å>/<Activityå>`                  | ç²¾ç¡®å¯åŠ¨ Activity |
| `adb shell am force-stop <åŒ…å>`                             | å¼ºåˆ¶åœæ­¢åº”ç”¨      |
| `adb shell pm clear <åŒ…å>`                                  | æ¸…é™¤åº”ç”¨æ•°æ®      |

------

### ğŸ“‚ å››ã€æ–‡ä»¶ä¼ è¾“ä¸ç®¡ç†



| å‘½ä»¤                             | è¯´æ˜                   |
| -------------------------------- | ---------------------- |
| `adb push <æœ¬åœ°æ–‡ä»¶> <è®¾å¤‡è·¯å¾„>` | å°†æ–‡ä»¶æ¨é€åˆ°è®¾å¤‡       |
| `adb pull <è®¾å¤‡æ–‡ä»¶> <æœ¬åœ°è·¯å¾„>` | å°†æ–‡ä»¶ä»è®¾å¤‡æ‹‰å–åˆ°æœ¬åœ° |
| `adb shell ls <è·¯å¾„>`            | æŸ¥çœ‹è®¾å¤‡ä¸Šçš„æ–‡ä»¶       |
| `adb shell rm <è·¯å¾„>`            | åˆ é™¤è®¾å¤‡ä¸Šçš„æ–‡ä»¶       |

------

### ğŸš äº”ã€Shell æ“ä½œ



| å‘½ä»¤                                      | è¯´æ˜             |
| ----------------------------------------- | ---------------- |
| `adb shell`                               | è¿›å…¥è®¾å¤‡ Shell   |
| `adb shell <å‘½ä»¤>`                        | åœ¨è®¾å¤‡ä¸Šæ‰§è¡Œå‘½ä»¤ |
| `adb shell dumpsys`                       | æŸ¥çœ‹ç³»ç»ŸæœåŠ¡ä¿¡æ¯ |
| `adb shell screencap /sdcard/screen.png`  | æˆªå›¾             |
| `adb shell screenrecord /sdcard/demo.mp4` | å½•å±             |
| `adb shell input text "hello"`            | æ¨¡æ‹Ÿè¾“å…¥         |
| `adb shell input tap x y`                 | æ¨¡æ‹Ÿç‚¹å‡»         |
| `adb shell input swipe x1 y1 x2 y2`       | æ¨¡æ‹Ÿæ»‘åŠ¨         |

------

### ğŸ§ª å…­ã€è°ƒè¯•ä¸æ—¥å¿—



| å‘½ä»¤                   | è¯´æ˜              |
| ---------------------- | ----------------- |
| `adb logcat`           | æŸ¥çœ‹è®¾å¤‡æ—¥å¿—      |
| `adb logcat -s <TAG>`  | è¿‡æ»¤æŒ‡å®š TAG æ—¥å¿— |
| `adb logcat > log.txt` | å°†æ—¥å¿—ä¿å­˜åˆ°æ–‡ä»¶  |
| `adb bugreport`        | è·å–å®Œæ•´ bug æŠ¥å‘Š |

------

### ğŸ§° ä¸ƒã€ç½‘ç»œä¸ç«¯å£è½¬å‘



| å‘½ä»¤                                | è¯´æ˜                       |
| ----------------------------------- | -------------------------- |
| `adb forward <æœ¬åœ°ç«¯å£> <è¿œç¨‹ç«¯å£>` | è®¾ç½®ç«¯å£è½¬å‘               |
| `adb reverse <è¿œç¨‹ç«¯å£> <æœ¬åœ°ç«¯å£>` | åå‘ç«¯å£è½¬å‘ï¼ˆé€‚ç”¨äºå¼€å‘ï¼‰ |

## å¸¸ç”¨å‘½ä»¤

```shell
# è·å–å±å¹•åˆ†è¾¨ç‡ï¼ˆå®½xé«˜ï¼‰  ä¾‹å¦‚è¾“å‡ºPhysical size: 1080x2340ï¼Œè¡¨ç¤ºå±å¹•å®½åº¦ 1080 åƒç´ ï¼Œé«˜åº¦ 2340 åƒç´ ã€‚
adb shell wm size

# æŸ¥çœ‹å·²è¿æ¥è®¾å¤‡åˆ—è¡¨
adb devices

# æŸ¥çœ‹æ‰‹æœºçš„å®‰å“ç‰ˆæœ¬å·ã€‚
adb shell getprop ro.build.version.release
```



#  è¡¥å……

##  æ— çº¿è¿æ¥æ‰‹æœºadb

> ç¯å¢ƒ:**æ‰‹æœºè¿æ¥å…¬å¸wifi**  **ç”µè„‘è¿æ¥çš„æ˜¯å…¬å¸ç½‘çº¿**

**æ‰‹æœºç«¯è®¾ç½®**

> æ‰“å¼€ **å¼€å‘è€…é€‰é¡¹ â†’ æ— çº¿è°ƒè¯•**ã€‚
>
> **ç„¶åç‚¹å‡»æ— çº¿è°ƒè¯• ä¼šå¼¹å‡ºé…å¯¹ä¿¡æ¯ç•Œé¢**



### **cmdå‘½ä»¤é…ç½®**

[**ä½¿ç”¨é…å¯¹ç é…å¯¹è®¾å¤‡**](https://blog.csdn.net/huaqianzkh/article/details/143199399)

> ä½¿ç”¨é…å¯¹ç 
>
> åœ¨æ‰‹æœºä¸Šç”Ÿæˆé…å¯¹ç ã€‚
>
> æ‰“å¼€ç”µè„‘ç»ˆç«¯ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š

```shell
# å‘½ä»¤
adb pair <æ‰‹æœºIPåœ°å€>:<ç«¯å£å·>


# å‘½ä»¤ç¤ºä¾‹
C:\Users\é“ºå…ˆç”ŸæŠ€æœ¯ç ”å‘ä¸­å¿ƒ>adb pair  192.168.110.89:46419
Enter pairing code: 425945         # code è¾“å…¥å¯¹åº”çš„code  
Successfully paired to 192.168.110.89:46419 [guid=adb-10CF4P0UGY002CU-lLcDqW]  # è¡¨æ˜æ‚¨çš„è®¾å¤‡å·²æˆåŠŸé…å¯¹

# è¿æ¥
C:\Users\é“ºå…ˆç”ŸæŠ€æœ¯ç ”å‘ä¸­å¿ƒ> adb connect 192.168.110.89:42457
connected to 192.168.110.89:42457

C:\Users\é“ºå…ˆç”ŸæŠ€æœ¯ç ”å‘ä¸­å¿ƒ>adb devices
List of devices attached
192.168.110.89:42457    device
```

## è·å–æ‰‹æœºä¸Šçš„ä½ç½®åæ ‡æ–¹æ¡ˆ

### æ˜¾ç¤ºè§¦æ‘¸ä½ç½®å’Œåæ ‡

åœ¨æ‰‹æœºä¸Šå¼€å¯ã€Œå¼€å‘è€…é€‰é¡¹ã€ä¸­çš„ï¼š

- **æŒ‡é’ˆä½ç½®**ï¼ˆæ˜¾ç¤ºè§¦æ‘¸ç‚¹åæ ‡ï¼‰
- **æ˜¾ç¤ºè§¦æ‘¸æ“ä½œ**ï¼ˆå¯è§†åŒ–è§¦æ‘¸åé¦ˆï¼‰

å¼€å¯åæ‰‹åŠ¨ç‚¹å‡»ç›®æ ‡ä½ç½®ï¼Œå±å¹•ä¼šæ˜¾ç¤ºè¯¥ç‚¹çš„å®æ—¶åæ ‡ï¼Œè®°ä¸‹åæ ‡åå†ç”¨ ADB å‘½ä»¤æ¨¡æ‹Ÿç‚¹å‡»ï¼š

```bash
adb shell input tap åæ ‡X åæ ‡Y
```

### é€šè¿‡å…ƒç´ å®šä½ï¼ˆæ›´ç²¾å‡†ï¼‰

å¦‚æœæ˜¯é’ˆå¯¹ç‰¹å®š APP æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨`uiautomator`å·¥å…·åˆ†æç•Œé¢å…ƒç´ ï¼š

> **ä¸ç”¨ä¸‹è½½ adbè‡ªå¸¦**

```bash
# ç”Ÿæˆå½“å‰ç•Œé¢çš„UIå±‚æ¬¡ç»“æ„æ–‡ä»¶
adb shell uiautomator dump /sdcard/ui.xml

# å°†æ–‡ä»¶å¯¼å‡ºåˆ°ç”µè„‘
adb pull /sdcard/ui.xml ./
```

æ‰“å¼€å¯¼å‡ºçš„`ui.xml`æ–‡ä»¶ï¼ŒæŸ¥æ‰¾ç›®æ ‡å…ƒç´ çš„`bounds`å±æ€§ï¼ˆå¦‚`bounds="[x1,y1][x2,y2]"`ï¼‰ï¼Œå–ä¸­é—´ç‚¹åæ ‡`((x1+x2)/2, (y1+y2)/2)`ä½œä¸ºç‚¹å‡»ä½ç½®ã€‚

### ä½¿ç”¨å¯è§†åŒ–å·¥å…·è¾…åŠ©

æ¨èä½¿ç”¨è¿™ç±»å·¥å…·ç›´è§‚å®šä½åæ ‡ï¼š

- **Scrcpy**ï¼šæŠ•å±åˆ°ç”µè„‘ï¼Œé¼ æ ‡æ‚¬åœæ—¶ä¼šæ˜¾ç¤ºå®æ—¶åæ ‡
- **Android Studio çš„ Layout Inspector**ï¼šç²¾ç¡®æŸ¥çœ‹ UI å…ƒç´ ä½ç½®
- **ADB Tools GUI**ï¼šéƒ¨åˆ†å›¾å½¢åŒ–å·¥å…·æ”¯æŒç‚¹å‡»å±å¹•ç›´æ¥ç”Ÿæˆ ADB å‘½ä»¤

# bugå¤„ç†

## adb.exe: more than one device/emulator

> å½“ä½¿ç”¨ ADB å‘½ä»¤æ—¶ï¼Œå¦‚æœè¿æ¥äº†å¤šä¸ªè®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨ï¼Œå¯èƒ½ä¼šå‡ºç° *error: more than one device and emulator* çš„é”™è¯¯ã€‚
>
> æ­¤é—®é¢˜é€šå¸¸æ˜¯ç”±äºæœªæ˜ç¡®æŒ‡å®šç›®æ ‡è®¾å¤‡å¯¼è‡´çš„ã€‚

è§£å†³æ–¹æ³•

1. æ£€æŸ¥è¿æ¥çš„è®¾å¤‡

é¦–å…ˆï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰è¿æ¥çš„è®¾å¤‡å’Œæ¨¡æ‹Ÿå™¨ï¼š

```shell
C:\Users\é“ºå…ˆç”ŸæŠ€æœ¯ç ”å‘ä¸­å¿ƒ>adb devices
List of devices attached
192.168.110.108:34701   offline
192.168.110.99:39469    offline
```

**å…³é—­å¤šä½™çš„æ¨¡æ‹Ÿå™¨**

```shell
adb disconnect
```

