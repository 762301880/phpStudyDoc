



# 建议

```sql
1. 新增字段请从最底部插入,不要从中间新增一条字段
2. 最好使用建模工具建表
```

### **一、前期设计准备**

1. **明确业务需求**建表前梳理业务场景，确定核心实体（如用户、订单）及实体间关系（一对一、一对多、多对多），避免后期频繁修改表结构。
   - 例：用户表（`users`）与订单表（`orders`）是一对多关系，`orders` 需添加 `user_id` 外键关联 `users.id`。
2. **遵循数据库设计原则**
   - **三范式**：减少冗余（如避免在订单表中重复存储用户名，应通过外键关联用户表）。
   - **适度反范式**：为查询性能，可合理冗余（如订单表冗余 `user_name`，避免联表查询）。

### **二、表结构设计规范**

1. **表名与字段名命名**

   - 统一小写，使用下划线分隔（如 `user_order` 而非 `UserOrder`），避免关键字（如 `order`、`user`）。
   - 表名建议加前缀区分模块（如 `sys_user` 系统用户、`pay_order` 支付订单）。
   - 字段名见名知意：`create_time`（创建时间）、`is_deleted`（逻辑删除标记）。

2. **主键设计**

   - 建议使用 **自增整数主键**（`INT UNSIGNED AUTO_INCREMENT` 或 `BIGINT UNSIGNED`），性能优于 UUID。
   - 主键命名统一为 `id`，避免 `user_id` 这类冗余命名。

3. **字段类型选择**

   - **数值型**：根据范围选择（`TINYINT` 0-255，`INT` 约 20 亿，超范围用 `BIGINT`），避免过大浪费空间。

   - **字符串**：固定长度用 `CHAR`（如手机号 `CHAR(11)`），可变长度用 `VARCHAR`（如用户名 `VARCHAR(50)`），长文本用 `TEXT`（避免滥用，影响性能）。

   - 时间类型

     ：

     - 用 `DATETIME` 存储具体时间（如 `2023-10-27 12:00:00`，不受时区影响）。
     - 用 `TIMESTAMP` 记录时间戳（受时区影响，适合跨时区场景）。
     - 新增 / 更新时间建议默认值：`create_time DATETIME DEFAULT CURRENT_TIMESTAMP`，`update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP`。

4. **非空约束（NOT NULL）**

   - 尽量给字段加 `NOT NULL`，避免 `NULL` 值导致查询异常（如 `NULL != NULL`），用默认值替代（如 `status TINYINT NOT NULL DEFAULT 0`）。

5. **索引设计**

   - 主键默认是聚簇索引，无需重复创建。
   - 高频查询字段加索引（如 `user_id`、`order_no`），但避免过度索引（影响插入 / 更新性能）。
   - 联合索引遵循 “最左前缀原则”（如 `(a,b)` 索引，能优化 `WHERE a=?` 但不能优化 `WHERE b=?`）。
   - 在 Navicat 中可通过 “设计表”→“索引” 标签页添加，指定索引类型（`BTREE` 常用，`HASH` 适合等值查询）。

6. **外键约束（谨慎使用）**

   - 外键可保证数据一致性（如删除用户时限制删除其关联订单），但会降低写入性能，高并发场景建议业务层控制，而非依赖数据库外键。
   - Navicat 中在 “设计表”→“外键” 标签页设置，关联字段类型需一致（如 `orders.user_id` 与 `users.id` 均为 `INT`）。

7. **逻辑删除**避免物理删除（`DELETE`），用字段标记删除状态（如 `is_deleted TINYINT NOT NULL DEFAULT 0`，`1` 表示删除），查询时默认过滤 `WHERE is_deleted=0`。

### **三、Navicat 操作技巧**

1. **可视化建表步骤**

   - 右键数据库→“新建表”，在 “字段” 标签页填写字段名、类型、长度、约束等。
   - 切换到 “选项” 标签页，设置表的存储引擎（默认 `InnoDB`，支持事务和外键）、字符集（`utf8mb4` 兼容 emoji，避免 `utf8`）、排序规则（`utf8mb4_general_ci` 或 `utf8mb4_unicode_ci`）。

2. **批量操作与脚本生成**

   - 建表后可通过 “工具”→“导出向导” 生成 SQL 脚本，便于版本控制。

   - 多表操作时，用 “查询” 窗口编写

      

     ```
     CREATE TABLE
     ```

      

     语句批量执行，比手动点击更高效。

     

     例：

     sql

     

     

     

     

     

     ```sql
     CREATE TABLE `users` (
       `id` INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
       `username` VARCHAR(50) NOT NULL COMMENT '用户名',
       `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
       INDEX `idx_username` (`username`)
     ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';
     ```

     

3. **注释规范**

   - 表和字段添加注释（Navicat 中 “注释” 列填写），便于维护（如 `COMMENT '用户表'`）。

4. **检查表结构**

   - 建表后通过 “设计表” 核对字段类型、索引、约束是否符合预期，或用 `SHOW CREATE TABLE 表名;` 查看生成的 SQL 语句。

### **四、性能与扩展性考虑**

1. **分表分库预留**大表（如订单表）提前规划分表字段（如按时间 `create_time` 分表 `order_2023`、`order_2024`），字段设计避免影响分表逻辑。
2. **避免大字段**图片、文件等大内容不要存在数据库，存储路径即可，用 `VARCHAR` 保存文件 URL。
3. **定期维护**用 Navicat 的 “表维护” 功能（右键表→“维护”）优化表、分析索引，提升查询性能。

遵循以上建议，能让表结构更规范、高效，减少后期维护成本。根据实际业务场景灵活调整，不必生搬硬套。