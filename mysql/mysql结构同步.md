## 结构同步工具

在 MySQL 数据库管理中，结构对比同步工具能帮助开发者或 DBA 高效对比不同环境（如开发、测试、生产）的表结构差异，并实现同步，以下是一些常用的工具及特点：

### 1. **Navicat Premium**（可视化工具,功能全面）

- 特点：
  - 支持多数据库类型（MySQL、PostgreSQL、SQL Server 等），集成了 “结构同步” 功能。
  - 可直观对比两个数据库的表、字段、索引、约束等结构差异，生成差异报告。
  - 支持一键生成同步 SQL 脚本，或直接执行同步操作（需谨慎，建议先备份）。
- 操作步骤：
  1. 连接两个需要对比的数据库。
  2. 右键目标数据库 → 选择 “结构同步” → 选择源数据库。
  3. 查看差异列表，勾选需要同步的项，生成脚本或直接同步。

### 2. **MySQL Workbench**（官方工具，免费）

- 特点：
  - MySQL 官方提供的可视化工具，内置 “Schema Synchronization” 功能。
  - 支持对比本地模型与远程数据库、两个远程数据库的结构差异。
  - 可生成 ALTER 语句脚本，手动执行同步，安全性较高。
- 操作步骤：
  1. 打开 “Database” → “Schema Synchronization Wizard”。
  2. 选择源和目标数据库（可选择模型文件或连接）。
  3. 对比后生成差异脚本，检查无误后执行。

### 3. **pt-table-sync**（Percona Toolkit，命令行工具）

- 特点：

  - Percona 提供的开源命令行工具集，`pt-table-sync` 可用于同步表结构和数据。
  - 适合通过脚本自动化执行，支持复杂的同步规则（如忽略某些表）。
  - 需注意：默认同步数据，需通过参数指定仅同步结构（需结合 `pt-show-grants` 等工具配合）。

- 示例命令：

  ```bash
  pt-table-sync --databases db1 db2 --execute  # 同步 db1 和 db2 的表结构（需谨慎测试）
  ```

  

### 4. **SchemaSpy**（生成结构文档 + 对比）

- 特点：
  - 生成数据库结构文档（HTML 格式），支持对比两个版本的文档差异。
  - 需通过查看文档中的 “差异标记” 手动分析结构变化，适合审计和记录。
- 使用方式：
  1. 分别为两个数据库生成结构文档。
  2. 通过工具（如 Beyond Compare）对比文档目录，定位差异。

### 5. **Liquibase/Flyway**（版本化迁移工具，适合迭代同步）

- 特点：
  - 并非直接对比工具，而是通过 “版本化 SQL 脚本” 管理结构变更。
  - 每次结构修改生成对应的迁移脚本（如 `V1__create_table.sql`），通过工具自动执行到目标库，确保环境一致性。
  - 适合团队协作和持续集成（CI/CD）流程，避免手动同步的风险。

### 6. **自定义脚本（Python/Shell + SQL）**

- 若需灵活控制对比逻辑，可通过脚本实现：
  - 读取源库和目标库的 `INFORMATION_SCHEMA`（如 `COLUMNS`、`TABLES` 表），获取结构元数据。
  - 编写逻辑对比字段名、类型、长度、索引等差异。
  - 自动生成 `ALTER TABLE` 语句，执行同步（建议先输出脚本人工审核）。

### 注意事项：

1. **同步前备份**：结构变更可能导致数据丢失，务必先备份目标库。
2. **生产环境谨慎操作**：建议先在测试环境验证同步脚本，再在业务低峰执行。
3. **权限控制**：确保工具或脚本拥有足够的 DDL 权限（如 `ALTER`），但避免过度授权。

根据场景选择工具：可视化工具适合临时对比，命令行 / 脚本工具适合自动化，版本化迁移工具适合长期迭代管理。

# https://github.com/TiCodeX/SQLSchemaCompare